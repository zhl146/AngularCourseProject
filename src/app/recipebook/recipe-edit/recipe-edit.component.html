<form [formGroup]="recipeForm"
      novalidate
      (ngSubmit)='onSubmit()' fxLayoutWrap>

  <md-card fxLayoutWrap
           fxLayout="row"
           fxLayoutAlign.lt-md="center center">
      <md-input-container fxFlex.lt-md="100">
          <input type="text"
                 placeholder="Recipe Name"
                 fxFlex.lt-md="100"
                 mdInput
                 formControlName="recName">
      </md-input-container>

      <md-input-container fxFlex.lt-md="100">
        <textarea rows="1"
                  fxFlex.lt-md="100"
                  placeholder="Recipe Image Path"
                  mdTextareaAutosize
                  mdAutosizeMinRows="1"
                  mdInput
                  #imgPath
                  [id]="imgPath"
                  name="textarea"
                  formControlName="recImgPath">
      </textarea>
      </md-input-container>

      <img md-card-image
           [src]="imgPath.value">

  </md-card>
  <md-card fxLayout="row" fxLayoutWrap>

    <md-input-container fxFlex.lt-md="100">
    <textarea rows="1"
              fxFlex.lt-md="100"
              placeholder="Recipe Description"
              mdTextareaAutosize
              mdAutosizeMinRows="1"
              mdInput
              name="textarea"
              formControlName="recDescription">

      </textarea>
    </md-input-container>

    <md-input-container fxFlex.lt-md="50">
      <input fxFlex.lt-md="100"
             mdInput
             placeholder="Prep time in minutes"
             class="form-control"
             type="text"
             formControlName="recPrep">
    </md-input-container>
    <md-input-container fxFlex.lt-md="50">
      <input fxFlex.lt-md="100"
             mdInput
             placeholder="Cook time in minutes"
             class="form-control"
             type="text"
             formControlName="recCook">
    </md-input-container>
  </md-card>


  <div formArrayName="recIng" fxLayout="row" fxLayoutAlign="center" fxLayoutWrap>

    <md-card *ngFor="let ingCtrl of recipeForm.get('recIng').controls; let i=index"
             [formGroupName]="i"
             [ngClass]="{last: isLastElement(i, 'recIng')}"
             fxFlex="100"
             class="shopping-card"
             fxLayoutAlign="center center">

      <a (click)="addItemFuncFactory('recIng')()"
         class="list-button"
         *ngIf="isLastElement(i, 'recIng')">
        <md-icon >
          add
        </md-icon>
      </a>

      <md-input-container fxFlex>
        <textarea type="text"
                  rows="1"
                  mdTextareaAutosize
                  mdAutosizeMinRows="1"
                  mdInput
                  formControlName="text"
                  (keyup)="autoAddNewItem(i, 'recIng')">
        </textarea>
      </md-input-container>

      <a class="list-button">
        <div class="icon-placeholder"
             *ngIf="isLastElement(i, 'recIng')">
        </div>
        <md-icon (click)="onDeleteClicked(i, 'recIng')"
                 *ngIf="!isLastElement(i, 'recIng')">
          delete
        </md-icon>
      </a>

    </md-card>

  </div>

  <hr>

  <div formArrayName="recStep" fxLayout="row" fxLayoutAlign="center" fxLayoutWrap>

    <md-card *ngFor="let stepCtrl of recipeForm.get('recStep').controls; let i=index"
             [formGroupName]="i"
             [ngClass]="{last: isLastElement(i, 'recStep')}"
             fxFlex="100"
             class="shopping-card"
             fxLayoutAlign="center center">

      <a (click)="addItemFuncFactory('recStep')()"
         *ngIf="isLastElement(i, 'recStep')">
        <md-icon >
          add
        </md-icon>
      </a>

      <md-input-container fxFlex>
        <textarea type="text"
                  rows="1"
                  mdTextareaAutosize
                  mdAutosizeMinRows="1"
                  mdInput
                  formControlName="text"
                  (keyup)="autoAddNewItem(i, 'recStep')">
        </textarea>
      </md-input-container>

      <a class="list-button">
        <div class="icon-placeholder"
             *ngIf="isLastElement(i, 'recStep')">
        </div>
        <md-icon (click)="onDeleteClicked(i, 'recStep')"
                 *ngIf="!isLastElement(i, 'recStep')">
          delete
        </md-icon>
      </a>

    </md-card>

  </div>

  <button md-raised-button color="primary" fxFlex.lt-md="50">
    Save Recipe
  </button>
  <button type="button"
          md-raised-button
          color="accent"
          fxFlex.lt-md="50" [routerLink]="['/recipes']">
    Cancel Edit
  </button>
</form>
